# Система прогнозирования лесных пожаров

## Департамент по чрезвычайным ситуациям города Павлодар

Веб-приложение для прогнозирования пожарной опасности на основе метеорологических данных с использованием индекса Нестерова и упрощенного Канадского индекса FWI.

## Возможности

- **Расчет индексов пожарной опасности**
  - Индекс Нестерова (показатель горимости)
  - Канадский индекс FWI (Fire Weather Index)
  - Комплексный индекс с учетом типа растительности

- **Уровни опасности**
  - Низкий (зеленый)
  - Средний (желтый)
  - Высокий (оранжевый)
  - Чрезвычайный (красный)

- **Функционал**
  - Ввод метеоданных вручную
  - Загрузка данных из CSV/Excel файлов
  - Интерактивная карта Павлодарской области с зонами риска
  - Графики изменения показателей
  - История прогнозов с фильтрацией
  - Экспорт отчетов в PDF
  - Экспорт данных в CSV
  - Темная и светлая тема
  - Адаптивный дизайн

## Технологии

### Backend
- Python 3.10+
- FastAPI
- SQLite
- Pandas, NumPy
- ReportLab (генерация PDF)
- OpenPyXL (работа с Excel)

### Frontend
- React 18
- TypeScript
- Vite
- Tailwind CSS
- Recharts (графики)
- React-Leaflet (карты)
- Lucide React (иконки)

## Структура проекта

```
bosss/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py          # Главный модуль FastAPI
│   │   ├── models.py        # Модели данных Pydantic
│   │   ├── fire_index.py    # Расчет индексов пожарной опасности
│   │   ├── database.py      # Работа с SQLite
│   │   └── pdf_generator.py # Генерация PDF отчетов
│   ├── requirements.txt
│   └── venv/
├── frontend/
│   ├── src/
│   │   ├── components/      # React компоненты
│   │   ├── hooks/           # Кастомные хуки
│   │   ├── lib/             # Утилиты
│   │   ├── types/           # TypeScript типы
│   │   ├── App.tsx          # Главный компонент
│   │   └── main.tsx         # Точка входа
│   ├── package.json
│   └── vite.config.ts
└── README.md
```

## Установка и запуск

### Backend

1. Перейдите в директорию backend:
```bash
cd backend
```

2. Создайте виртуальное окружение:
```bash
python -m venv venv
```

3. Активируйте виртуальное окружение:
```bash
# Windows
.\venv\Scripts\activate

# Linux/MacOS
source venv/bin/activate
```

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

5. Запустите сервер:
```bash
uvicorn app.main:app --reload --port 8000
```

API будет доступен по адресу: http://localhost:8000
Документация API: http://localhost:8000/api/docs

### Frontend

1. Перейдите в директорию frontend:
```bash
cd frontend
```

2. Установите зависимости:
```bash
npm install
```

3. Запустите в режиме разработки:
```bash
npm run dev
```

Приложение будет доступно по адресу: http://localhost:5173

## API Эндпоинты

| Метод | Путь | Описание |
|-------|------|----------|
| POST | /api/predict | Расчет прогноза пожарной опасности |
| POST | /api/upload | Загрузка CSV/Excel файла с данными |
| GET | /api/history | Получение истории прогнозов |
| GET | /api/zones | Получение зон риска для карты |
| GET | /api/statistics | Получение статистики за период |
| GET | /api/export/pdf | Экспорт отчета в PDF |
| GET | /api/export/csv | Экспорт данных в CSV |

## Формат входных данных

### Обязательные поля:
- `temperature` - Температура воздуха (°C)
- `humidity` - Влажность воздуха (%)
- `wind_speed` - Скорость ветра (м/с)
- `precipitation` - Осадки за сутки (мм)

### Опциональные поля:
- `wind_direction` - Направление ветра (С, СВ, В, ЮВ, Ю, ЮЗ, З, СЗ)
- `soil_moisture` - Влажность почвы (%)
- `vegetation_moisture` - Влажность растительности (%)
- `vegetation_type` - Тип растительности (coniferous, deciduous, mixed)
- `location_name` - Название точки наблюдения
- `latitude` - Широта
- `longitude` - Долгота

## Формула расчета

### Индекс Нестерова
```
Г = Σ(t × d)
```
где:
- t - температура воздуха в 13:00 (°C)
- d - дефицит влажности воздуха (гПа)

При осадках ≥ 3 мм индекс сбрасывается до 0.

### Классификация опасности
| Индекс | Уровень |
|--------|---------|
| 0-20 | Низкий |
| 20-50 | Средний |
| 50-75 | Высокий |
| >75 | Чрезвычайный |

## Демонстрационные данные

При первом запуске система автоматически создает демонстрационные данные для следующих точек мониторинга:
- Павлодар - Центр (52.29° с.ш., 76.97° в.д.)
- Баянаул (50.79° с.ш., 75.70° в.д.)
- Экибастуз (51.72° с.ш., 75.32° в.д.)
- Аксу (52.04° с.ш., 76.92° в.д.)
- Лесная зона Север (52.45° с.ш., 76.85° в.д.)
- Лесная зона Восток (52.30° с.ш., 77.20° в.д.)
- Иртышский район (52.00° с.ш., 76.50° в.д.)

## Лицензия

© 2024 Департамент по чрезвычайным ситуациям города Павлодар
